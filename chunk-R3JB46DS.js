import{a as Pe}from"./chunk-55MWEE4V.js";import{$ as be,Aa as we,Ca as je,Da as xe,Ga as Me,Ha as _e,Ia as Ie,Ma as De,N as ye,Na as Le,P as Se,_ as Ce,l as me,q as ge,ta as ve,y as he}from"./chunk-RT4L6TJ3.js";import{t as de}from"./chunk-ZOMRHQQG.js";import{$b as F,Bb as ie,Cb as B,Cc as se,Da as ee,Ec as ae,G as X,Ga as x,Gc as ce,Ha as te,Hc as pe,Ic as le,J as Z,Mc as ue,O as $,P,Ub as d,X as q,_ as w,b as Q,ca as E,d as N,ec as f,fc as m,gc as A,h as Y,hb as ne,hd as M,ia as l,id as _,jb as u,jd as W,n as G,pc as S,qa as H,qc as re,r as J,t as L,tb as oe,xa as k,xb as T,ya as j,yd as fe}from"./chunk-TTU3ZVAH.js";import{a as r,b as y}from"./chunk-JKOY2XUY.js";var Ee=(()=>{class e{constructor(){this.query=oe(""),this.queryChange=ee()}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=T({type:e,selectors:[["app-search-box"]],inputs:{query:[1,"query"]},outputs:{query:"queryChange",queryChange:"queryChange"},decls:1,vars:2,consts:[["p-icon","an an-magnifying-glass","p-placeholder","Pesquisar mutantes...","p-clean","","name","query","p-help","Efetue a busca utilizando Apelido, E-mail ou Nome",3,"ngModelChange","p-no-autocomplete","ngModel"]],template:function(o,i){o&1&&(f(0,"po-input",0),le("ngModelChange",function(a){return pe(i.query,a)||(i.query=a),a}),S("ngModelChange",function(a){return i.queryChange.emit(a)}),m()),o&2&&(d("p-no-autocomplete",!0),ce("ngModel",i.query))},dependencies:[he,me,ge,we,ve],encapsulation:2,changeDetection:0})}}return e})();function ke(e){let t=M(()=>e());return Oe(t)?new Proxy(e,{get(n,o){return o in t?(x(n[o])||Object.defineProperty(n,o,{value:_(()=>n()[o]),configurable:!0}),ke(n[o])):n[o]}}):e}var Ue=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function Oe(e){if(e===null||typeof e!="object"||Ke(e))return!1;let t=Object.getPrototypeOf(e);if(t===Object.prototype)return!0;for(;t&&t!==Object.prototype;){if(Ue.includes(t.constructor))return!1;t=Object.getPrototypeOf(t)}return t===Object.prototype}function Ke(e){return typeof e?.[Symbol.iterator]=="function"}var Ve=new WeakMap,c=Symbol("STATE_SOURCE");function g(e,...t){e[c].update(n=>t.reduce((o,i)=>r(r({},o),typeof i=="function"?i(o):i),n)),Ye(e)}function Qe(e){return e[c]()}function Ne(e){return Ve.get(e[c])||[]}function Ye(e){let t=Ne(e);for(let n of t){let o=M(()=>Qe(e));n(o)}}function Te(...e){let t=[...e],n=typeof t[0]=="function"?{}:t.shift(),o=t;return(()=>{class s{constructor(){let p=o.reduce((D,We)=>We(D),Ge()),{stateSignals:C,props:b,methods:v,hooks:h}=p,I=r(r(r({},C),b),v);this[c]=p[c];for(let D of Reflect.ownKeys(I))this[D]=I[D];let{onInit:K,onDestroy:V}=h;K&&K(),V&&l(j).onDestroy(V)}static \u0275fac=function(C){return new(C||s)};static \u0275prov=E({token:s,factory:s.\u0275fac,providedIn:n.providedIn||null})}return s})()}function Ge(){return{[c]:te({}),stateSignals:{},props:{},methods:{},hooks:{}}}function U(e){return t=>{let n=e(r(r(r({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),y(r({},t),{props:r(r({},t.props),n)})}}function Re(e){return U(e)}function qe(e){return t=>{let n=r(r(r({[c]:t[c]},t.stateSignals),t.props),t.methods),o=typeof e=="function"?e(n):e,i=s=>{let a=o[s],p=t.hooks[s];return a?()=>{p&&p(),a(n)}:p};return y(r({},t),{hooks:{onInit:i("onInit"),onDestroy:i("onDestroy")}})}}function He(e){return t=>{let n=e(r(r(r({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),y(r({},t),{methods:r(r({},t.methods),n)})}}function Be(e){return t=>{let n=typeof e=="function"?e():e,o=Reflect.ownKeys(n);t[c].update(s=>r(r({},s),n));let i=o.reduce((s,a)=>{let p=_(()=>t[c]()[a]);return y(r({},s),{[a]:ke(p)})},{});return y(r({},t),{stateSignals:r(r({},t.stateSignals),i)})}}var Fe=(()=>{class e{constructor(){this.http=l(fe)}getUsers(n=""){return this.http.get("assets/json/user.db.json").pipe(L(o=>o.users),L(o=>n?o.filter(i=>i.name.toLocaleLowerCase().includes(n.toLocaleLowerCase())||i.nickname.toLocaleLowerCase().includes(n.toLocaleLowerCase())||i.email.toLocaleLowerCase().includes(n.toLocaleLowerCase())):o))}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function R(e,t){t?.injector||H(R);let n=t?.injector??l(k),o=new Y,i=e(o).subscribe();n.get(j).onDestroy(()=>i.unsubscribe());let s=(a,p)=>{if(Je(a))return o.next(a),{destroy:Q};let C=Xe(),b=p?.injector??C??n;if(x(a)){let h=W(()=>{let I=a();M(()=>o.next(I))},{injector:b});return i.add({unsubscribe:()=>h.destroy()}),h}let v=a.subscribe(h=>o.next(h));return i.add(v),b!==n&&b.get(j).onDestroy(()=>v.unsubscribe()),{destroy:()=>v.unsubscribe()}};return s.destroy=i.unsubscribe.bind(i),s}function Je(e){return!x(e)&&!J(e)}function Xe(){try{return l(k)}catch{return}}function Ae(e,t,n){let o=typeof e=="function"?{next:e,error:t,complete:n}:e;return i=>i.pipe(w({next:o.next,complete:o.complete}),X(s=>(o.error(s),G)),o.finalize?P(o.finalize):s=>s)}var Ze={users:[],isLoading:!1,query:"",error:null},O=Te(Be(Ze),U(()=>({userService:l(Fe)})),Re(({users:e})=>({userCount:_(()=>e().length)})),He(e=>({updateQuery(t){g(e,{query:t})},loadUsers:R(t=>t.pipe(q(()=>e.userService.getUsers().pipe(w({next:n=>g(e,{users:n,isLoading:!1,error:null}),error:()=>g(e,{error:"Falha ao carregar usu\xE1rios",isLoading:!1})}))))),loadByQuery:R(N(Z(300),$(),w(()=>g(e,{isLoading:!0})),q(t=>e.userService.getUsers(t).pipe(Ae({next:n=>g(e,{users:n}),error:()=>g(e,{isLoading:!1,error:"Falha ao carregar usu\xE1rios"})}),P(()=>g(e,{isLoading:!1}))))))})),qe({onInit({loadByQuery:e,query:t}){e(t)}}));function $e(e,t){e&1&&A(0,"po-loading-overlay")}function et(e,t){if(e&1&&(f(0,"div",1),A(1,"po-info",9)(2,"po-info",10)(3,"po-info",11),m()),e&2){let n=t.$implicit;u(),d("p-value",n.nickname),u(),d("p-value",n.email),u(),d("p-value",n.description)}}function tt(e,t){if(e&1&&(f(0,"div",1)(1,"po-list-view",7),B(2,et,4,3,"ng-template",8),m()()),e&2){let n=re();u(),d("p-height",n.height)("p-items",n.store.users())}}var zt=(()=>{class e extends Pe{constructor(){super("signals/samples"),this.store=l(O),this.height=300}ngAfterViewInit(){this.onResize()}ngOnInit(){this.store.loadUsers()}onResize(){setTimeout(()=>this.setHeight(),200)}setHeight(){let n=[];n.push(this.getElementHeightById(".po-page-header")),n.push(this.getElementHeightById(".search")),this.height=this.calculateHeight(n)-150}getElementHeightById(n){let o=document.querySelector(n);return o?o.clientHeight:0}calculateHeight(n){return n.reduce((o,i)=>o-i,window.innerHeight)}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=T({type:e,selectors:[["app-signals-store"]],hostBindings:function(o,i){o&1&&S("resize",function(){return i.onResize()},!1,ne)},features:[ue([O]),ie],decls:10,vars:4,consts:[["p-title","Store","p-subtitle","Exemplo de uso do SignalsStore",3,"p-back"],[1,"po-row"],[1,"po-mb-5","po-sm-12","po-md-12","po-lg-12","po-xl-12"],[1,"po-row","search"],[1,"po-xl-3","po-lg-4","po-md-8","po-sm-12","po-mb-1",3,"queryChange","query"],[1,"po-xl-12","po-lg-12","po-md-12","po-sm-12","po-mb-2"],[1,"po-font-text-small"],["p-property-title","name",1,"po-sm-12","po-md-12","po-lg-12","po-xl-12",3,"p-height","p-items"],["p-list-view-content-template",""],["p-label","Apelido",1,"po-sm-12","po-md-6","po-lg-3","po-xl-3",3,"p-value"],["p-label","Email",1,"po-sm-12","po-md-6","po-lg-9","po-xl-9",3,"p-value"],["p-label","Descri\xE7\xE3o",1,"po-sm-12","po-md-12","po-lg-12","po-xl-12",3,"p-value"]],template:function(o,i){o&1&&(f(0,"po-page-detail",0),S("p-back",function(){return i.onBack()}),f(1,"div",1)(2,"po-container",2)(3,"div",3)(4,"app-search-box",4),S("queryChange",function(a){return i.store.updateQuery(a)}),m(),f(5,"div",5)(6,"p",6),se(7),m()()(),B(8,$e,1,0,"po-loading-overlay")(9,tt,3,2,"div",1),m()()()),o&2&&(u(4),d("query",i.store.query()),u(3),ae("Mutantes: ",i.store.userCount(),""),u(),F(i.store.isLoading()?8:-1),u(),F(i.store.isLoading()?-1:9))},dependencies:[de,Ee,Le,De,Se,ye,Ie,_e,Me,xe,je,be,Ce],encapsulation:2})}}return e})();export{zt as SignalsStoreComponent};
