import{a as p}from"./chunk-OFVM4HAG.js";import{$ as j,Aa as W,La as $,Na as G,O,Q as D,_ as k,k as I,l as w,n as E,na as q,p as T,q as x,x as F,xa as A}from"./chunk-V5TXKAIM.js";import{o as B}from"./chunk-ILNAH6AD.js";import{$b as s,Cc as f,Fc as S,Gc as C,Hc as M,Ic as b,Vc as y,Xc as _,Yb as h,Zb as N,a as u,ac as a,da as d,db as m,ia as n,md as P,nc as v,vb as g}from"./chunk-5QGOOW3X.js";import"./chunk-RTRJ3KFH.js";var J=(()=>{let e=class e{constructor(){this.eventBus=n(p),this.requestPermission()}requestPermission(){if("Notification"in window)Notification.requestPermission().then(t=>{});else return}showNotification(t,o){if(Notification.permission==="granted")new Notification(t,o);else return}sendNotification(t){let o={message:t,timestamp:new Date};this.eventBus.cast("notification",o),this.showNotification("Voc\xEA tem uma nova mensagem",{body:t,icon:"an an-bell"})}};e.\u0275fac=function(o){return new(o||e)},e.\u0275prov=d({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var L=(i,e)=>e.message;function R(i,e){if(i&1&&(s(0,"div",6),f(1),y(2,"date"),a()),i&2){let l=e.$implicit;m(),S("",l.message," (",_(2,2,l.timestamp,"shortTime"),")")}}function Y(i,e){i&1&&(s(0,"p"),f(1,"Nenhuma mensagem encontrada."),a())}var V="NOTIFICATIONS",pe=(()=>{let e=class e{constructor(){this.message=P(""),this.eventBus$=new u,this.notifications=[],this.notificationService=n(J),this.poNotification=n(q),this.eventBus=n(p)}sendMessage(){if(!this.message()){this.poNotification.error("Mensagem n\xE3o pode ser vazia");return}this.notificationService.sendNotification(this.message()),this.message.update(()=>"")}ngOnInit(){this.getNotificationsBySessionStorage(),this.eventBus$=this.eventBus.on("notification").subscribe(t=>{this.notifications.push(t.data),sessionStorage.setItem(V,JSON.stringify(this.notifications))})}ngOnDestroy(){this.eventBus$.unsubscribe()}getNotificationsBySessionStorage(){let t=sessionStorage.getItem(V)||"";try{if(t){let o=JSON.parse(t);this.notifications=o}}catch{return}}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=g({type:e,selectors:[["app-notifications"]],inputs:{message:[1,"message"]},outputs:{message:"messageChange"},decls:10,vars:2,consts:[["p-title","Notifica\xE7\xF5es","p-subtitle","Exemplo de uso do ng-event-bus"],[1,"po-row"],[1,"po-sm-12","po-md-12","po-lg-12","po-xl-12","po-mb-2"],["p-label","Mensagem","name","message","p-help","Insira a mensagem que deseja notificar o usuario","p-placeholder","Insira a sua mensagem aqui...",3,"ngModelChange","ngModel"],["p-label","Enviar","p-kind","primary",3,"p-click"],[1,"po-sm-12","po-md-12","po-lg-12","po-xl-12"],[1,"po-font-text"]],template:function(o,r){o&1&&(s(0,"po-page-default",0)(1,"div",1)(2,"po-container",2)(3,"form")(4,"po-textarea",3),b("ngModelChange",function(c){return M(r.message,c)||(r.message=c),c}),a(),s(5,"po-button",4),v("p-click",function(){return r.sendMessage()}),a()()(),s(6,"po-container",5),h(7,R,3,5,"div",6,L,!1,Y,2,0,"p"),a()()()),o&2&&(m(4),C("ngModel",r.message),m(3),N(r.notifications))},dependencies:[G,$,W,A,D,O,F,x,I,w,T,E,j,k,B],encapsulation:2});let i=e;return i})();export{pe as NotificationsComponent};
