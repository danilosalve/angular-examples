import{cd as g,da as w,dd as p,ia as j,ta as M,wa as l,xa as D}from"./chunk-5QGOOW3X.js";import{a as o,b as u}from"./chunk-RTRJ3KFH.js";var b=Symbol("DEEP_SIGNAL");function v(t){return new Proxy(t,{has(e,n){return!!this.get(e,n,void 0)},get(e,n){let s=g(e);return!C(s)||!(n in s)?(l(e[n])&&e[n][b]&&delete e[n],e[n]):(l(e[n])||(Object.defineProperty(e,n,{value:p(()=>e()[n]),configurable:!0}),e[n][b]=!0),v(e[n]))}})}var E=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function C(t){if(t===null||typeof t!="object"||O(t))return!1;let e=Object.getPrototypeOf(t);if(e===Object.prototype)return!0;for(;e&&e!==Object.prototype;){if(E.includes(e.constructor))return!1;e=Object.getPrototypeOf(e)}return e===Object.prototype}function O(t){return typeof t?.[Symbol.iterator]=="function"}var P=new WeakMap,c=Symbol("STATE_SOURCE");function B(t,...e){let n=g(()=>I(t)),s=e.reduce((r,a)=>o(o({},r),typeof a=="function"?a(r):a),n),f=t[c],i=Reflect.ownKeys(t[c]);for(let r of Reflect.ownKeys(s))if(i.includes(r)){let a=r;n[a]!==s[a]&&f[a].set(s[a])}W(t)}function I(t){let e=t[c];return Reflect.ownKeys(t[c]).reduce((n,s)=>{let f=e[s]();return u(o({},n),{[s]:f})},{})}function T(t){return P.get(t[c])||[]}function W(t){let e=T(t);for(let n of e){let s=g(()=>I(t));n(s)}}function H(...t){let e=[...t],n=typeof e[0]=="function"?{}:e.shift(),s=e;return(()=>{class i{constructor(){let a=s.reduce((d,x)=>x(d),A()),{stateSignals:y,props:R,methods:K,hooks:k}=a,h=o(o(o({},y),R),K);this[c]=a[c];for(let d of Reflect.ownKeys(h))this[d]=h[d];let{onInit:S,onDestroy:m}=k;S&&S(),m&&j(M).onDestroy(m)}static \u0275fac=function(y){return new(y||i)};static \u0275prov=w({token:i,factory:i.\u0275fac,providedIn:n.providedIn||null})}return i})()}function A(){return{[c]:{},stateSignals:{},props:{},methods:{},hooks:{}}}function U(t){return e=>{let n=t(o(o(o({[c]:e[c]},e.stateSignals),e.props),e.methods));return u(o({},e),{props:o(o({},e.props),n)})}}function V(t){return U(e=>{let n=t(e);return Reflect.ownKeys(n).reduce((f,i)=>{let r=n[i];return u(o({},f),{[i]:l(r)?r:p(r)})},{})})}function $(t){return e=>{let n=o(o(o({[c]:e[c]},e.stateSignals),e.props),e.methods),s=typeof t=="function"?t(n):t,f=(i,r)=>r?()=>{i&&i(),r(n)}:i;return u(o({},e),{hooks:{onInit:f(e.hooks.onInit,s.onInit),onDestroy:f(e.hooks.onDestroy,s.onDestroy)}})}}function J(t){return e=>{let n=t(o(o(o({[c]:e[c]},e.stateSignals),e.props),e.methods));return u(o({},e),{methods:o(o({},e.methods),n)})}}function Q(t){return e=>{let n=typeof t=="function"?t():t,s=Reflect.ownKeys(n),f=e[c],i={};for(let r of s)f[r]=D(n[r]),i[r]=v(f[r]);return u(o({},e),{stateSignals:o(o({},e.stateSignals),i)})}}export{B as a,H as b,U as c,V as d,$ as e,J as f,Q as g};
