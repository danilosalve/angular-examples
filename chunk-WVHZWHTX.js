import{a as p}from"./chunk-WHQ7DOPZ.js";import{$ as D,Ba as A,Ma as W,O as F,Oa as $,Q as O,_ as k,l as B,m as I,na as j,o as w,q as E,r as T,y as x,ya as q}from"./chunk-6F6IX55Z.js";import{o as P}from"./chunk-ZOMRHQQG.js";import{Cc as f,Fc as C,Gc as S,Hc as _,Ic as y,Sc as M,Uc as b,a as l,ca as u,cc as h,dc as N,ec as n,fc as s,ia as o,jb as m,pc as v,tb as d,xb as g}from"./chunk-TTU3ZVAH.js";import"./chunk-JKOY2XUY.js";var G=(()=>{class t{constructor(){this.eventBus=o(p),this.requestPermission()}requestPermission(){if("Notification"in window)Notification.requestPermission().then(e=>{});else return}showNotification(e,i){if(Notification.permission==="granted")new Notification(e,i);else return}sendNotification(e){let i={message:e,timestamp:new Date};this.eventBus.cast("notification",i),this.showNotification("Voc\xEA tem uma nova mensagem",{body:e,icon:"an an-bell"})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var K=(t,r)=>r.message;function L(t,r){if(t&1&&(n(0,"div",6),f(1),M(2,"date"),s()),t&2){let e=r.$implicit;m(),C("",e.message," (",b(2,2,e.timestamp,"shortTime"),")")}}function R(t,r){t&1&&(n(0,"p"),f(1,"Nenhuma mensagem encontrada."),s())}var J="NOTIFICATIONS",me=(()=>{class t{constructor(){this.message=d(""),this.eventBus$=new l,this.notifications=[],this.notificationService=o(G),this.poNotification=o(j),this.eventBus=o(p)}sendMessage(){if(!this.message()){this.poNotification.error("Mensagem n\xE3o pode ser vazia");return}this.notificationService.sendNotification(this.message()),this.message.update(()=>"")}ngOnInit(){this.getNotificationsBySessionStorage(),this.eventBus$=this.eventBus.on("notification").subscribe(e=>{this.notifications.push(e.data),sessionStorage.setItem(J,JSON.stringify(this.notifications))})}ngOnDestroy(){this.eventBus$.unsubscribe()}getNotificationsBySessionStorage(){let e=sessionStorage.getItem(J)||"";try{if(e){let i=JSON.parse(e);this.notifications=i}}catch{return}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=g({type:t,selectors:[["app-notifications"]],inputs:{message:[1,"message"]},outputs:{message:"messageChange"},decls:10,vars:2,consts:[["p-title","Notifica\xE7\xF5es","p-subtitle","Exemplo de uso do ng-event-bus"],[1,"po-row"],[1,"po-sm-12","po-md-12","po-lg-12","po-xl-12","po-mb-2"],["p-label","Mensagem","name","message","p-help","Insira a mensagem que deseja notificar o usuario","p-placeholder","Insira a sua mensagem aqui...",3,"ngModelChange","ngModel"],["p-label","Enviar","p-kind","primary",3,"p-click"],[1,"po-sm-12","po-md-12","po-lg-12","po-xl-12"],[1,"po-font-text"]],template:function(i,a){i&1&&(n(0,"po-page-default",0)(1,"div",1)(2,"po-container",2)(3,"form")(4,"po-textarea",3),y("ngModelChange",function(c){return _(a.message,c)||(a.message=c),c}),s(),n(5,"po-button",4),v("p-click",function(){return a.sendMessage()}),s()()(),n(6,"po-container",5),h(7,L,3,5,"div",6,K,!1,R,2,0,"p"),s()()()),i&2&&(m(4),S("ngModel",a.message),m(3),N(a.notifications))},dependencies:[$,W,A,q,O,F,x,T,B,I,E,w,P,D,k],encapsulation:2})}}return t})();export{me as NotificationsComponent};
