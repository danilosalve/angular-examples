import{a as Ee}from"./chunk-LOSKFKWO.js";import{A as ye,Aa as Ie,B as Se,Ea as De,Fa as Pe,aa as Ce,ba as be,j as me,la as ve,o as ge,sa as we,ua as je,va as xe,w as he,ya as Me,za as _e}from"./chunk-PJGXJYGO.js";import"./chunk-YQH3U43A.js";import{$ as w,Ab as ie,Ac as ae,Cb as B,Cc as ce,Dc as pe,Ea as ee,Ec as le,G as X,Ia as x,Ic as ue,J as Z,Ja as te,Kd as de,P as $,Q as E,Ub as d,Vd as fe,Y as R,_b as F,b as Q,bd as M,d as Y,da as k,dc as f,dd as _,ec as m,ed as W,fc as U,gb as ne,h as G,ib as u,ja as l,lc as S,mc as re,n as J,r as N,ra as H,sb as oe,t as P,wb as T,ya as L,yc as se,za as j}from"./chunk-EQ2ZZIGX.js";import{a as r,b as y}from"./chunk-4CLCTAJ7.js";var ke=(()=>{class e{constructor(){this.query=oe(""),this.queryChange=ee()}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=T({type:e,selectors:[["app-search-box"]],inputs:{query:[1,"query"]},outputs:{query:"queryChange",queryChange:"queryChange"},decls:1,vars:2,consts:[["p-icon","an an-magnifying-glass","p-placeholder","Pesquisar usu\xE1rios...","p-clean","","name","query",3,"ngModelChange","p-no-autocomplete","ngModel"]],template:function(o,i){o&1&&(f(0,"po-input",0),le("ngModelChange",function(a){return pe(i.query,a)||(i.query=a),a}),S("ngModelChange",function(a){return i.queryChange.emit(a)}),m()),o&2&&(d("p-no-autocomplete",!0),ce("ngModel",i.query))},dependencies:[he,me,ge,we,ve],encapsulation:2,changeDetection:0})}}return e})();function Le(e){let t=_(()=>e());return Oe(t)?new Proxy(e,{get(n,o){return o in t?(x(n[o])||Object.defineProperty(n,o,{value:M(()=>n()[o]),configurable:!0}),Le(n[o])):n[o]}}):e}var ze=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function Oe(e){if(e===null||typeof e!="object"||Ke(e))return!1;let t=Object.getPrototypeOf(e);if(t===Object.prototype)return!0;for(;t&&t!==Object.prototype;){if(ze.includes(t.constructor))return!1;t=Object.getPrototypeOf(t)}return t===Object.prototype}function Ke(e){return typeof e?.[Symbol.iterator]=="function"}var Ve=new WeakMap,c=Symbol("STATE_SOURCE");function g(e,...t){e[c].update(n=>t.reduce((o,i)=>r(r({},o),typeof i=="function"?i(o):i),n)),Ge(e)}function Qe(e){return e[c]()}function Ye(e){return Ve.get(e[c])||[]}function Ge(e){let t=Ye(e);for(let n of t){let o=_(()=>Qe(e));n(o)}}function Te(...e){let t=[...e],n=typeof t[0]=="function"?{}:t.shift(),o=t;return(()=>{class s{constructor(){let p=o.reduce((D,We)=>We(D),Je()),{stateSignals:C,props:b,methods:v,hooks:h}=p,I=r(r(r({},C),b),v);this[c]=p[c];for(let D of Reflect.ownKeys(I))this[D]=I[D];let{onInit:K,onDestroy:V}=h;K&&K(),V&&l(j).onDestroy(V)}static \u0275fac=function(C){return new(C||s)};static \u0275prov=k({token:s,factory:s.\u0275fac,providedIn:n.providedIn||null})}return s})()}function Je(){return{[c]:te({}),stateSignals:{},props:{},methods:{},hooks:{}}}function z(e){return t=>{let n=e(r(r(r({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),y(r({},t),{props:r(r({},t.props),n)})}}function qe(e){return z(e)}function Re(e){return t=>{let n=r(r(r({[c]:t[c]},t.stateSignals),t.props),t.methods),o=typeof e=="function"?e(n):e,i=s=>{let a=o[s],p=t.hooks[s];return a?()=>{p&&p(),a(n)}:p};return y(r({},t),{hooks:{onInit:i("onInit"),onDestroy:i("onDestroy")}})}}function He(e){return t=>{let n=e(r(r(r({[c]:t[c]},t.stateSignals),t.props),t.methods));return Reflect.ownKeys(n),y(r({},t),{methods:r(r({},t.methods),n)})}}function Be(e){return t=>{let n=typeof e=="function"?e():e,o=Reflect.ownKeys(n);t[c].update(s=>r(r({},s),n));let i=o.reduce((s,a)=>{let p=M(()=>t[c]()[a]);return y(r({},s),{[a]:Le(p)})},{});return y(r({},t),{stateSignals:r(r({},t.stateSignals),i)})}}var Fe=(()=>{class e{constructor(){this.http=l(fe)}getUsers(n=""){return this.http.get("assets/json/user.db.json").pipe(P(o=>o.users),P(o=>n?o.filter(i=>i.name.toLocaleLowerCase().includes(n.toLocaleLowerCase())||i.nickname.toLocaleLowerCase().includes(n.toLocaleLowerCase())):o))}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function q(e,t){t?.injector||H(q);let n=t?.injector??l(L),o=new G,i=e(o).subscribe();n.get(j).onDestroy(()=>i.unsubscribe());let s=(a,p)=>{if(Ne(a))return o.next(a),{destroy:Q};let C=Xe(),b=p?.injector??C??n;if(x(a)){let h=W(()=>{let I=a();_(()=>o.next(I))},{injector:b});return i.add({unsubscribe:()=>h.destroy()}),h}let v=a.subscribe(h=>o.next(h));return i.add(v),b!==n&&b.get(j).onDestroy(()=>v.unsubscribe()),{destroy:()=>v.unsubscribe()}};return s.destroy=i.unsubscribe.bind(i),s}function Ne(e){return!x(e)&&!N(e)}function Xe(){try{return l(L)}catch{return}}function Ue(e,t,n){let o=typeof e=="function"?{next:e,error:t,complete:n}:e;return i=>i.pipe(w({next:o.next,complete:o.complete}),X(s=>(o.error(s),J)),o.finalize?E(o.finalize):s=>s)}var Ze={users:[],isLoading:!1,query:"",error:null},O=Te(Be(Ze),z(()=>({userService:l(Fe)})),qe(({users:e})=>({userCount:M(()=>e().length)})),He(e=>({updateQuery(t){g(e,{query:t})},loadUsers:q(t=>t.pipe(R(()=>e.userService.getUsers().pipe(w({next:n=>g(e,{users:n,isLoading:!1,error:null}),error:()=>g(e,{error:"Falha ao carregar usu\xE1rios",isLoading:!1})}))))),loadByQuery:q(Y(Z(300),$(),w(()=>g(e,{isLoading:!0})),R(t=>e.userService.getUsers(t).pipe(Ue({next:n=>g(e,{users:n}),error:()=>g(e,{isLoading:!1,error:"Falha ao carregar usu\xE1rios"})}),E(()=>g(e,{isLoading:!1}))))))})),Re({onInit({loadByQuery:e,query:t}){e(t)}}));function $e(e,t){e&1&&U(0,"po-loading-overlay")}function et(e,t){if(e&1&&(f(0,"div",1),U(1,"po-info",9)(2,"po-info",10)(3,"po-info",11),m()),e&2){let n=t.$implicit;u(),d("p-value",n.nickname),u(),d("p-value",n.email),u(),d("p-value",n.description)}}function tt(e,t){if(e&1&&(f(0,"div",1)(1,"po-list-view",7),B(2,et,4,3,"ng-template",8),m()()),e&2){let n=re();u(),d("p-height",n.height)("p-items",n.store.users())}}var zt=(()=>{class e extends Ee{constructor(){super("signals/samples"),this.store=l(O),this.height=300}ngAfterViewInit(){this.onResize()}ngOnInit(){this.store.loadUsers()}onResize(){setTimeout(()=>this.setHeight(),200)}setHeight(){let n=[];n.push(this.getElementHeightById(".po-page-header")),n.push(this.getElementHeightById(".search")),this.height=this.calculateHeight(n)-150}getElementHeightById(n){let o=document.querySelector(n);return o?o.clientHeight:0}calculateHeight(n){return n.reduce((o,i)=>o-i,window.innerHeight)}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275cmp=T({type:e,selectors:[["app-signals-store"]],hostBindings:function(o,i){o&1&&S("resize",function(){return i.onResize()},!1,ne)},features:[ue([O]),ie],decls:10,vars:4,consts:[["p-title","Store","p-subtitle","Exemplo de uso do SignalsStore",3,"p-back"],[1,"po-row"],[1,"po-mb-5","po-sm-12","po-md-12","po-lg-12","po-xl-12"],[1,"po-row","search"],[1,"po-xl-3","po-lg-4","po-md-8","po-sm-12","po-mb-1",3,"queryChange","query"],[1,"po-xl-12","po-lg-12","po-md-12","po-sm-12","po-mb-2"],[1,"po-font-text-small"],["p-property-title","name",1,"po-sm-12","po-md-12","po-lg-12","po-xl-12",3,"p-height","p-items"],["p-list-view-content-template",""],["p-label","Apelido",1,"po-sm-12","po-md-6","po-lg-3","po-xl-3",3,"p-value"],["p-label","Email",1,"po-sm-12","po-md-6","po-lg-9","po-xl-9",3,"p-value"],["p-label","Descri\xE7\xE3o",1,"po-sm-12","po-md-12","po-lg-12","po-xl-12",3,"p-value"]],template:function(o,i){o&1&&(f(0,"po-page-detail",0),S("p-back",function(){return i.onBack()}),f(1,"div",1)(2,"po-container",2)(3,"div",3)(4,"app-search-box",4),S("queryChange",function(a){return i.store.updateQuery(a)}),m(),f(5,"div",5)(6,"p",6),se(7),m()()(),B(8,$e,1,0,"po-loading-overlay")(9,tt,3,2,"div",1),m()()()),o&2&&(u(4),d("query",i.store.query()),u(3),ae("Usu\xE1rios: ",i.store.userCount(),""),u(),F(i.store.isLoading()?8:-1),u(),F(i.store.isLoading()?-1:9))},dependencies:[de,ke,Pe,De,Se,ye,Ie,_e,Me,xe,je,be,Ce],encapsulation:2})}}return e})();export{zt as SignalsStoreComponent};
