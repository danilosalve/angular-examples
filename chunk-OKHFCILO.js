import{$ as y,Ba as R,F as r,H as w,I as i,O as v,Oa as I,T as x,aa as H,ac as S,fa as c,ga as l,hc as T,ja as b,ka as u,la as h,oc as B,q as f,qa as m,qc as V,sa as L,u as _,x as P,xa as E,y as C,ya as a,za as p}from"./chunk-YWKGHEJU.js";import{d as g}from"./chunk-4CLCTAJ7.js";var z=(()=>{class o{constructor(){this._apiUrl="https://rickandmortyapi.com/api/character",this.page=r(1),this.response=r([]),this.getPersons=I({request:this.page,loader:s=>g(this,[s],function*({request:e,abortSignal:t}){try{let n=yield(yield fetch(`${this._apiUrl}/?page=${e}`,{signal:t})).json();if(this.response().length>0){let d=this.response().concat(n.results);this.response.set(d)}else this.response.set(n.results);return this.response()}catch(n){this.handleError(n)}})})}updatePage(e){this.page.set(e)}handleError(e){throw console.error("An error occurred:",e),e}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=f({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var k=()=>[];function q(o,M){if(o&1&&(c(0,"p"),m(1,"Ops, ocorreu erro ao tentar listar os Usu\xE1rios :("),l(),m(2)),o&2){h();let e=p(4);i(2),L(" ",e," ")}}function A(o,M){if(o&1){let e=b();c(0,"po-table",2),u("p-show-more",function(){P(e);let s=h();return C(s.loadPersons())}),l()}if(o&2){let e=h(),t=p(1),s=p(2),n=p(3);y("p-items",t)("p-show-more-disabled",!s)("p-loading",n)("p-height",e.height)}}var Q=(()=>{class o{constructor(){this.page=r(1),this.personsService=_(z),this.personsResource=this.personsService.getPersons,this.height=400}ngAfterViewInit(){this.onResize()}loadPersons(){this.page.update(e=>e+1),this.personsService.updatePage(this.page())}restartPersons(){this.personsResource.reload()}onResize(){setTimeout(()=>this.setHeight(),200)}setHeight(){let e=[];e.push(this.getElementHeightById(".po-page-header")),e.push(this.getElementHeightById(".po-row po-table-footer-show-more ng-star-inserted")),this.height=this.calculateHeight(e)-145}getElementHeightById(e){let t=document.querySelector(e);return t?t.clientHeight:0}calculateHeight(e){return e.reduce((t,s)=>t-s,window.innerHeight)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=v({type:o,selectors:[["app-persons"]],hostBindings:function(t,s){t&1&&u("resize",function(){return s.onResize()},!1,w)},decls:7,vars:6,consts:[["p-title","Rick & Morty | Personagens","p-subtitle","Exemplo de uso da API resource"],[3,"p-items","p-show-more-disabled","p-loading","p-height"],[3,"p-show-more","p-items","p-show-more-disabled","p-loading","p-height"]],template:function(t,s){if(t&1&&(c(0,"po-page-default",0),E(1)(2)(3)(4),x(5,q,3,1)(6,A,1,4,"po-table",1),l()),t&2){let n;i(),a((n=s.personsResource.value())!==null&&n!==void 0?n:R(5,k)),i(),a(s.personsResource.hasValue()),i(),a(s.personsResource.isLoading()),i();let d=a(s.personsResource.error());i(),H(d?5:6)}},dependencies:[V,B,T,S],encapsulation:2})}}return o})();export{Q as PersonsComponent};
